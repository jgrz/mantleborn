<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grimoire | Game Wizard</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* ============================================
           GRIMOIRE - Knowledge Base
           ============================================ */

        :root {
            /* Backgrounds */
            --bg-deep: #0d0d14;
            --bg-mid: #1a1a2e;
            --bg-surface: #252542;

            /* Accents - mystic purple/gold */
            --accent-purple: #9b6dff;
            --accent-purple-glow: #b794ff;
            --accent-gold: #ffd700;
            --accent-dark: #4a3a6a;

            /* Stone/neutral tones */
            --stone-dark: #3a3a5c;
            --stone-mid: #6a6a8e;
            --stone-light: #9a9abe;
            --stone-bright: #d0d0e8;

            /* Status colors */
            --success: #4ade80;
            --error: #f87171;
            --warning: #fbbf24;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-deep);
            color: var(--stone-light);
            min-height: 100vh;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: var(--bg-mid);
            border-bottom: 1px solid var(--stone-dark);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .home-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            font-size: 18px;
            text-decoration: none;
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 4px;
            transition: all 0.2s;
        }

        .home-btn:hover {
            background: var(--stone-dark);
            border-color: var(--accent-purple);
        }

        .brand-icon {
            font-size: 20px;
        }

        .brand-text {
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            color: var(--stone-mid);
        }

        .brand-text span {
            color: var(--accent-purple);
            text-shadow: 0 0 10px rgba(155, 109, 255, 0.5);
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 4px;
            min-width: 300px;
        }

        .search-box input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: var(--stone-bright);
            font-family: inherit;
            font-size: 12px;
        }

        .search-box input::placeholder {
            color: var(--stone-mid);
        }

        .search-icon {
            color: var(--stone-mid);
        }

        /* Main Layout */
        .main {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: calc(100vh - 53px);
        }

        /* Sidebar */
        .sidebar {
            background: var(--bg-mid);
            border-right: 1px solid var(--stone-dark);
            padding: 20px 0;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-header {
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            color: var(--stone-mid);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 20px;
            margin-bottom: 12px;
        }

        .nav-list {
            list-style: none;
        }

        .nav-item {
            display: block;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            color: var(--stone-light);
            text-decoration: none;
            font-size: 13px;
            transition: all 0.15s;
            border-left: 3px solid transparent;
        }

        .nav-link:hover {
            background: var(--bg-surface);
            color: var(--stone-bright);
        }

        .nav-link.active {
            background: var(--accent-dark);
            border-left-color: var(--accent-purple);
            color: var(--accent-purple-glow);
        }

        .nav-icon {
            font-size: 16px;
            width: 24px;
            text-align: center;
        }

        .nav-badge {
            margin-left: auto;
            padding: 2px 8px;
            background: var(--accent-dark);
            border-radius: 10px;
            font-size: 10px;
            color: var(--accent-purple);
        }

        /* Content Area */
        .content {
            padding: 32px 48px;
            max-width: 900px;
            overflow-y: auto;
        }

        .content-header {
            margin-bottom: 32px;
        }

        .content-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 16px;
            color: var(--stone-bright);
            margin-bottom: 12px;
        }

        .content-subtitle {
            font-size: 14px;
            color: var(--stone-mid);
            line-height: 1.6;
        }

        /* Tool Cards */
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 32px;
        }

        .tool-card {
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
        }

        .tool-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(155, 109, 255, 0.2);
        }

        .tool-card-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .tool-card-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            color: var(--stone-bright);
            margin-bottom: 8px;
        }

        .tool-card-desc {
            font-size: 12px;
            color: var(--stone-mid);
            line-height: 1.5;
        }

        .tool-card-count {
            margin-top: 12px;
            font-size: 11px;
            color: var(--accent-purple);
        }

        /* Article Styles */
        .article {
            line-height: 1.7;
        }

        .article h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            color: var(--stone-bright);
            margin: 32px 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--stone-dark);
        }

        .article h3 {
            font-size: 14px;
            font-weight: 600;
            color: var(--stone-bright);
            margin: 24px 0 12px 0;
        }

        .article p {
            margin-bottom: 16px;
            color: var(--stone-light);
        }

        .article ul, .article ol {
            margin: 0 0 16px 24px;
            color: var(--stone-light);
        }

        .article li {
            margin-bottom: 8px;
        }

        .article code {
            background: var(--bg-deep);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            color: var(--accent-purple);
        }

        .article pre {
            background: var(--bg-deep);
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 16px;
        }

        .article pre code {
            background: none;
            padding: 0;
        }

        .article kbd {
            display: inline-block;
            padding: 3px 8px;
            background: var(--bg-mid);
            border: 1px solid var(--stone-dark);
            border-radius: 4px;
            font-family: inherit;
            font-size: 11px;
            color: var(--stone-bright);
            box-shadow: 0 2px 0 var(--stone-dark);
        }

        .article .tip {
            background: rgba(155, 109, 255, 0.1);
            border-left: 3px solid var(--accent-purple);
            padding: 12px 16px;
            margin: 16px 0;
            border-radius: 0 6px 6px 0;
        }

        .article .tip-title {
            font-weight: 600;
            color: var(--accent-purple);
            margin-bottom: 4px;
        }

        .article .warning {
            background: rgba(251, 191, 36, 0.1);
            border-left: 3px solid var(--warning);
            padding: 12px 16px;
            margin: 16px 0;
            border-radius: 0 6px 6px 0;
        }

        .article .warning-title {
            font-weight: 600;
            color: var(--warning);
            margin-bottom: 4px;
        }

        /* Article Navigation */
        .article-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
        }

        .article-nav-link {
            padding: 8px 16px;
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 4px;
            color: var(--stone-light);
            text-decoration: none;
            font-size: 12px;
            transition: all 0.15s;
        }

        .article-nav-link:hover {
            background: var(--accent-dark);
            border-color: var(--accent-purple);
            color: var(--accent-purple-glow);
        }

        .article-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }

        .article-card {
            padding: 16px;
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .article-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-2px);
        }

        .article-card-title {
            font-size: 13px;
            color: var(--stone-bright);
        }

        .back-link {
            display: inline-block;
            margin-bottom: 16px;
            color: var(--accent-purple);
            text-decoration: none;
            font-size: 12px;
        }

        .back-link:hover {
            color: var(--accent-purple-glow);
            text-decoration: underline;
        }

        /* Tool Overview */
        .tool-overview {
            margin-bottom: 32px;
            line-height: 1.6;
        }

        .tool-overview p {
            color: var(--stone-light);
            margin-bottom: 20px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .feature-item {
            display: flex;
            gap: 12px;
            padding: 16px;
            background: var(--bg-surface);
            border: 1px solid var(--stone-dark);
            border-radius: 6px;
        }

        .feature-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .feature-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .feature-text strong {
            color: var(--stone-bright);
            font-size: 13px;
        }

        .feature-text span {
            color: var(--stone-mid);
            font-size: 12px;
            line-height: 1.4;
        }

        .docs-section-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            color: var(--stone-mid);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 32px 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--stone-dark);
        }

        /* Step styling from docs */
        .article .step {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-surface);
            border-radius: 6px;
        }

        .article .step-num {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--accent-dark);
            color: var(--accent-purple);
            border-radius: 50%;
            font-weight: 600;
            flex-shrink: 0;
        }

        .article .step-text {
            flex: 1;
        }

        .article .tip-label,
        .article .warning-label {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .article .tip-label {
            color: var(--accent-purple);
        }

        .article .warning-label {
            color: var(--warning);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--stone-dark);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-deep);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="brand">
            <a href="/game-wizard/" class="home-btn" title="Back to Game Wizard">&#128302;</a>
            <span class="brand-icon">&#128214;</span>
            <span class="brand-text">GAME WIZARD / <span>GRIMOIRE</span></span>
        </div>
        <div class="header-actions">
            <div class="search-box">
                <span class="search-icon">&#128269;</span>
                <input type="text" placeholder="Search the knowledge base..." id="searchInput">
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-header">Getting Started</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#welcome" class="nav-link active">
                            <span class="nav-icon">&#128302;</span>
                            Welcome
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#overview" class="nav-link">
                            <span class="nav-icon">&#128506;</span>
                            Overview
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#ai-generation" class="nav-link">
                            <span class="nav-icon">&#129302;</span>
                            AI Generation
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-header">Tools</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#tilesmith" class="nav-link">
                            <span class="nav-icon">&#129513;</span>
                            Tilesmith
                            <span class="nav-badge">5</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#sprite-rite" class="nav-link">
                            <span class="nav-icon">&#128123;</span>
                            Sprite-Rite
                            <span class="nav-badge">6</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#animancer" class="nav-link">
                            <span class="nav-icon">&#127916;</span>
                            Animancer
                            <span class="nav-badge">6</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#level-forge" class="nav-link">
                            <span class="nav-icon">&#128293;</span>
                            Level Forge
                            <span class="nav-badge">8</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#incarnum" class="nav-link">
                            <span class="nav-icon">&#129497;</span>
                            Incarnum
                            <span class="nav-badge">8</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#crucible" class="nav-link">
                            <span class="nav-icon">&#129514;</span>
                            Crucible of Code
                            <span class="nav-badge">8</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#portals" class="nav-link">
                            <span class="nav-icon">&#128279;</span>
                            Portals
                            <span class="nav-badge">6</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-header">Reference</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#shortcuts" class="nav-link">
                            <span class="nav-icon">&#9000;</span>
                            Keyboard Shortcuts
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#pixel-art" class="nav-link">
                            <span class="nav-icon">&#127912;</span>
                            Pixel Art Tips
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Content -->
        <div class="content" id="content">
            <!-- Welcome Page (default) -->
            <div id="page-welcome">
                <div class="content-header">
                    <h1 class="content-title">Welcome to the Grimoire</h1>
                    <p class="content-subtitle">
                        The internal knowledge base for Mantle's Game Wizard toolchain.
                        Everything you need to build custom games for Mantle customers.
                    </p>
                </div>

                <div class="article">
                    <h2>What is Game Wizard?</h2>
                    <p>Game Wizard is Mantle's internal game development toolkit. It provides a browser-based suite of specialized tools for creating 2D pixel art games from scratch. Each tool handles a specific part of the development pipeline, and they all work together through a shared project system.</p>

                    <p>This toolchain was built to streamline game creation for Mantle customers. Instead of juggling separate applications for sprites, animations, and level design, everything lives in one connected environment with data flowing seamlessly between tools.</p>

                    <h2>The Grimoire</h2>
                    <p>This documentation covers every tool in detail. Whether you're creating your first tile or exporting a complete game, you'll find step-by-step guides, feature explanations, and workflow tips here.</p>

                    <div class="tip">
                        <div class="tip-label">Getting Started</div>
                        Read the <a href="#overview" style="color: var(--accent-purple);">Overview</a> to understand how all the tools connect, then dive into any tool's documentation from the sidebar.
                    </div>
                </div>

                <h2 class="docs-section-title">Tools</h2>
                <div class="tool-grid">
                    <a href="#tilesmith" class="tool-card">
                        <div class="tool-card-icon">&#129513;</div>
                        <div class="tool-card-title">Tilesmith</div>
                        <div class="tool-card-desc">
                            Create pixel art tiles with AI assistance. Support for multi-tile tilesets.
                        </div>
                        <div class="tool-card-count">5 articles</div>
                    </a>

                    <a href="#sprite-rite" class="tool-card">
                        <div class="tool-card-icon">&#128123;</div>
                        <div class="tool-card-title">Sprite-Rite</div>
                        <div class="tool-card-desc">
                            Import and manage sprite assets. Define regions and generate atlases.
                        </div>
                        <div class="tool-card-count">6 articles</div>
                    </a>

                    <a href="#animancer" class="tool-card">
                        <div class="tool-card-icon">&#127916;</div>
                        <div class="tool-card-title">Animancer</div>
                        <div class="tool-card-desc">
                            Build frame-by-frame animations with timeline and playback controls.
                        </div>
                        <div class="tool-card-count">6 articles</div>
                    </a>

                    <a href="#level-forge" class="tool-card">
                        <div class="tool-card-icon">&#128293;</div>
                        <div class="tool-card-title">Level Forge</div>
                        <div class="tool-card-desc">
                            Design levels with collision grids, backgrounds, visual tiles, and demo mode.
                        </div>
                        <div class="tool-card-count">8 articles</div>
                    </a>

                    <a href="#incarnum" class="tool-card">
                        <div class="tool-card-icon">&#129497;</div>
                        <div class="tool-card-title">Incarnum</div>
                        <div class="tool-card-desc">
                            Assemble characters from sprites and animations. Define types, tags, and properties.
                        </div>
                        <div class="tool-card-count">8 articles</div>
                    </a>

                    <a href="#crucible" class="tool-card">
                        <div class="tool-card-icon">&#129514;</div>
                        <div class="tool-card-title">Crucible of Code</div>
                        <div class="tool-card-desc">
                            Project command center. Manage levels and export game-ready JSON.
                        </div>
                        <div class="tool-card-count">8 articles</div>
                    </a>

                    <a href="#portals" class="tool-card">
                        <div class="tool-card-icon">&#128279;</div>
                        <div class="tool-card-title">Portals</div>
                        <div class="tool-card-desc">
                            Connect levels together. Link exits to spawns for level transitions.
                        </div>
                        <div class="tool-card-count">6 articles</div>
                    </a>

                    <a href="#shortcuts" class="tool-card">
                        <div class="tool-card-icon">&#9000;</div>
                        <div class="tool-card-title">Keyboard Shortcuts</div>
                        <div class="tool-card-desc">
                            Quick reference for all keyboard shortcuts across tools.
                        </div>
                        <div class="tool-card-count">Reference</div>
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Load documentation modules -->
    <script src="../shared/docs/tilesmith-docs.js"></script>
    <script src="../shared/docs/sprite-rite-docs.js"></script>
    <script src="../shared/docs/animancer-docs.js"></script>
    <script src="../shared/docs/level-forge-docs.js"></script>
    <script src="../shared/docs/incarnum-docs.js"></script>
    <script src="../shared/docs/crucible-docs.js"></script>
    <script src="../shared/docs/portals-docs.js"></script>

    <script>
        // Simple client-side routing
        const pages = {
            welcome: document.getElementById('page-welcome').innerHTML,
            overview: `
                <div class="content-header">
                    <h1 class="content-title">Overview</h1>
                    <p class="content-subtitle">How all the Game Wizard tools work together to create complete games.</p>
                </div>
                <div class="article">
                    <h2>The Big Picture</h2>
                    <p>Game Wizard is organized around a central concept: <strong>Projects</strong>. A project represents a complete game and contains all its assets—sprites, animations, levels, and connections between them.</p>

                    <p>Each tool in Game Wizard specializes in one part of the game creation process, but they all share data through the project system. This means sprites you create in Tilesmith automatically appear in Animancer and Level Forge. Levels you design flow into the Crucible for export.</p>

                    <h2>How Data Flows</h2>
                    <p>Here's the typical workflow from start to finish:</p>

                    <div class="feature-grid" style="margin: 20px 0;">
                        <div class="feature-item">
                            <span class="feature-icon">1️⃣</span>
                            <div class="feature-text">
                                <strong>Create a Project</strong>
                                <span>Start in the <strong>Crucible of Code</strong>. Create a new project and define your levels. Each project gets its own master spritesheet.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">2️⃣</span>
                            <div class="feature-text">
                                <strong>Build Your Sprites</strong>
                                <span>Use <strong>Tilesmith</strong> to draw original tiles or <strong>Sprite-Rite</strong> to import existing sprite assets. Both publish to the project's master sheet.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">3️⃣</span>
                            <div class="feature-text">
                                <strong>Create Animations</strong>
                                <span>In <strong>Animancer</strong>, build frame sequences from your sprites. Define walk cycles, attacks, effects—anything that moves.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">4️⃣</span>
                            <div class="feature-text">
                                <strong>Define Characters</strong>
                                <span><strong>Incarnum</strong> assembles characters from sprites and animations. Set types, link behaviors, add tags and properties.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">5️⃣</span>
                            <div class="feature-text">
                                <strong>Design Levels</strong>
                                <span><strong>Level Forge</strong> is where levels take shape. Paint collision grids, add backgrounds, place visual tiles, and test with built-in demo mode.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">6️⃣</span>
                            <div class="feature-text">
                                <strong>Connect Levels</strong>
                                <span>Use <strong>Portals</strong> to link levels together. Define how exits lead to spawn points, creating your game's level flow.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">7️⃣</span>
                            <div class="feature-text">
                                <strong>Export</strong>
                                <span>Back in the <strong>Crucible</strong>, compile everything and export game-ready JSON for your engine.</span>
                            </div>
                        </div>
                    </div>

                    <h2>The Master Spritesheet</h2>
                    <p>Each project has a <strong>master spritesheet</strong>—a single combined image containing all sprites for that game. This is important for game performance and simplifies asset loading.</p>
                    <ul>
                        <li><strong>Tilesmith</strong> tiles publish directly to the master sheet</li>
                        <li><strong>Sprite-Rite</strong> imported sprites publish to the master sheet</li>
                        <li><strong>Animancer</strong> reads sprites from the master sheet</li>
                        <li><strong>Level Forge</strong> paints with sprites from the master sheet</li>
                    </ul>
                    <p>When you select a project in any tool, that project's master spritesheet loads automatically.</p>

                    <h2>Tool Responsibilities</h2>

                    <h3>Crucible of Code</h3>
                    <p>The command center. Create and manage projects, track level completion status, and export final game data. This is where you start and where you finish.</p>

                    <h3>Tilesmith</h3>
                    <p>Pixel art creation from scratch. Draw tiles manually or generate them with AI assistance. Supports single tiles and multi-tile grids (for larger assets like trees or buildings).</p>

                    <h3>Sprite-Rite</h3>
                    <p>Asset import and management. If you have existing spritesheets, bring them in here. Define sprite regions, name them, and publish to your project.</p>

                    <h3>Animancer</h3>
                    <p>Animation assembly. Take static sprites and arrange them into animated sequences. Control frame timing, preview playback, and define the animations your game will use.</p>

                    <h3>Incarnum</h3>
                    <p>Character definition and assembly. Combine sprites and animations into character templates with types (playable, NPC, enemy, object), tags for categorization, and custom properties for game data.</p>

                    <h3>Level Forge</h3>
                    <p>Level design workspace with three editing modes:</p>
                    <ul>
                        <li><strong>Grid Tab</strong> - Define collision and gameplay logic (walkable, solid, spawn points, exits)</li>
                        <li><strong>BG Tab</strong> - Add background layers with parallax scrolling</li>
                        <li><strong>Tiles Tab</strong> - Paint visual sprites onto the level</li>
                    </ul>
                    <p>Includes a demo mode to playtest levels immediately.</p>

                    <h3>Portals</h3>
                    <p>Level flow visualization. See all your levels as nodes on a canvas and draw connections between them. Validate that all exits lead somewhere and all spawns are reachable.</p>

                    <div class="tip">
                        <div class="tip-label">Workflow Tip</div>
                        Keep multiple tools open in browser tabs. Design sprites in one tab, paint levels in another, and refresh to see updates flow between them.
                    </div>
                </div>
            `,
            'ai-generation': `
                <div class="content-header">
                    <h1 class="content-title">AI Generation</h1>
                    <p class="content-subtitle">Generate pixel art assets with PixelLab AI across all Game Wizard tools.</p>
                </div>
                <div class="article">
                    <h2>Overview</h2>
                    <p>Game Wizard integrates <strong>PixelLab AI</strong> for generating pixel art assets. You can generate characters, animations, tilesets, and individual tiles directly within the tools—no external software needed.</p>

                    <p>All generation is <strong>asynchronous</strong> (takes 2-5 minutes) and tracked in a shared queue visible across all tools. Start a job in one tool, continue working, and import the result when it's ready.</p>

                    <h2>Generation Capabilities</h2>

                    <div class="feature-grid" style="margin: 20px 0;">
                        <div class="feature-item">
                            <span class="feature-icon">&#129302;</span>
                            <div class="feature-text">
                                <strong>Characters</strong>
                                <span>Multi-directional spritesheets (4 or 8 directions) with precise pose control via skeleton editor.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#127916;</span>
                            <div class="feature-text">
                                <strong>Animations</strong>
                                <span>Walk cycles, attacks, and custom actions for existing PixelLab characters.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#129513;</span>
                            <div class="feature-text">
                                <strong>Wang Tilesets</strong>
                                <span>16-tile terrain transitions (grass→dirt) and platform sets with autotile support.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#127912;</span>
                            <div class="feature-text">
                                <strong>Single Tiles</strong>
                                <span>Individual props, decorations, and isometric tiles for manual editing.</span>
                            </div>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#128230;</span>
                            <div class="feature-text">
                                <strong>Map Objects</strong>
                                <span>Props and decorations: treasure chests, crystals, barrels, trees.</span>
                            </div>
                        </div>
                    </div>

                    <h2>Where to Generate</h2>

                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                        <thead>
                            <tr style="background: var(--bg-surface); text-align: left;">
                                <th style="padding: 12px; border: 1px solid var(--stone-dark);">Asset Type</th>
                                <th style="padding: 12px; border: 1px solid var(--stone-dark);">Tool</th>
                                <th style="padding: 12px; border: 1px solid var(--stone-dark);">Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Character</td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);"><strong>Sprite-Rite</strong> or <strong>Incarnum</strong></td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Sprite-Rite for quick generation, Incarnum for full character setup</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Animation</td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);"><strong>Animancer</strong></td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Requires existing PixelLab character</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Wang Tileset</td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);"><strong>Tilesmith</strong> or <strong>Level Forge</strong></td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Tilesmith for editing, Level Forge for direct use</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Single Tile</td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);"><strong>Tilesmith</strong></td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Isometric tiles, props for manual editing</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Map Object</td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);"><strong>Sprite-Rite</strong> or <strong>Tilesmith</strong></td>
                                <td style="padding: 12px; border: 1px solid var(--stone-dark);">Sprite-Rite for master sheet, Tilesmith for editing</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>The Generation Queue</h2>
                    <p>Every tool displays a <strong>generation queue panel</strong> in the bottom-right corner. This queue is shared—jobs started in any tool appear everywhere.</p>

                    <ul>
                        <li><strong>⏳ Processing</strong> — Generation in progress (2-5 minutes)</li>
                        <li><strong>✅ Complete</strong> — Ready to import with the Import button</li>
                        <li><strong>❌ Failed</strong> — Click Retry to try again</li>
                    </ul>

                    <p>You can continue working in any tool while jobs process. The queue persists across page refreshes.</p>

                    <h2>Skeleton Editor</h2>
                    <p>Character generation includes a <strong>skeleton editor</strong> for precise pose control:</p>

                    <ul>
                        <li><strong>Drag joints</strong> — Head, shoulders, elbows, hands, hips, knees, feet</li>
                        <li><strong>Preset poses</strong> — Idle, Walk 1, Walk 2, Attack, Jump</li>
                        <li><strong>Guidance slider</strong> — Control how strictly the AI follows your pose (0-5)</li>
                        <li><strong>Reset</strong> — Return to default pose</li>
                    </ul>

                    <p>The skeleton editor appears in <strong>Sprite-Rite</strong> (character generation) and <strong>Incarnum</strong> (PixelLab engine).</p>

                    <h2>Style Settings</h2>
                    <p>Consistent style settings are available across all generation types:</p>

                    <ul>
                        <li><strong>Outline</strong> — None, black outline, or colored outline</li>
                        <li><strong>Shading</strong> — Flat, basic, or detailed shading</li>
                        <li><strong>Detail</strong> — Low, medium, or high detail level</li>
                    </ul>

                    <div class="tip">
                        <div class="tip-label">Consistency Tip</div>
                        Use the same style settings across all assets in a project for visual coherence. You can set project-wide defaults in Crucible's settings.
                    </div>

                    <h2>Tileset Generation</h2>
                    <p>Wang tilesets generate 16 tiles for terrain transitions:</p>

                    <h3>Top-Down Terrain</h3>
                    <p>For RPGs and top-down games. Describe two materials (e.g., "grass" and "dirt path") and the AI generates all transition tiles between them.</p>

                    <h3>Sidescroller Platforms</h3>
                    <p>For platformers. Describe a platform material (e.g., "stone brick") with optional surface decoration ("mossy", "cracked") to get edge pieces and middle sections.</p>

                    <h3>Chaining Tilesets</h3>
                    <p>For multi-terrain games, chain tilesets together:</p>
                    <ol>
                        <li>Generate grass → dirt tileset</li>
                        <li>Generate dirt → water tileset using the first as a base</li>
                        <li>The AI maintains material consistency across sets</li>
                    </ol>

                    <h2>Workflow Examples</h2>

                    <h3>Creating a Character from Scratch</h3>
                    <ol>
                        <li>Open <strong>Incarnum</strong>, select PixelLab engine</li>
                        <li>Describe your character ("brave knight with silver armor")</li>
                        <li>Adjust pose in skeleton editor</li>
                        <li>Set directions (4 or 8), size, and style</li>
                        <li>Generate → Wait → Import</li>
                        <li>In <strong>Sprite-Rite</strong>, auto-detect each direction and save to master sheet</li>
                        <li>Return to <strong>Incarnum</strong> and assign sprites</li>
                    </ol>

                    <h3>Building a Complete Tileset</h3>
                    <ol>
                        <li>Open <strong>Tilesmith</strong>, click AI Generate</li>
                        <li>Select "Wang Tileset" and "Top-Down Terrain"</li>
                        <li>Enter lower material ("ocean water") and upper ("sandy beach")</li>
                        <li>Generate → Wait → Import</li>
                        <li>4×4 grid auto-populates with all 16 tiles</li>
                        <li>Edit individual tiles with drawing tools if needed</li>
                        <li>Save to project for use in Level Forge</li>
                    </ol>

                    <h3>Adding Animations to an Existing Character</h3>
                    <ol>
                        <li>Ensure character was created via PixelLab (has character ID)</li>
                        <li>Open <strong>Animancer</strong>, click AI Generate</li>
                        <li>Select the character and choose animation template (Walk, Attack, etc.)</li>
                        <li>Add optional custom description</li>
                        <li>Generate → Wait → Import to timeline</li>
                        <li>Adjust timing and save</li>
                    </ol>

                    <div class="warning">
                        <div class="warning-label">API Requirements</div>
                        AI generation requires a configured PixelLab API token in your Supabase project secrets. Contact your administrator if generation isn't working.
                    </div>
                </div>
            `
        };

        // Helper to build tool documentation pages
        function buildToolDocs(toolId, toolName, toolDesc, toolOverview, docs) {
            if (!docs) return;

            pages[toolId] = `
                <div class="content-header">
                    <h1 class="content-title">${toolName}</h1>
                    <p class="content-subtitle">${toolDesc}</p>
                </div>
                <div class="tool-overview">
                    ${toolOverview}
                </div>
                <h2 class="docs-section-title">Documentation</h2>
                <nav class="article-nav">
                    ${docs.map(doc => `<a href="#${toolId}/${doc.id}" class="article-nav-link">${doc.title}</a>`).join('')}
                </nav>
            `;

            docs.forEach(doc => {
                pages[toolId + '/' + doc.id] = `
                    <div class="content-header">
                        <a href="#${toolId}" class="back-link">← Back to ${toolName}</a>
                        <h1 class="content-title">${doc.title}</h1>
                    </div>
                    <div class="article">
                        ${doc.content}
                    </div>
                `;
            });
        }

        // Tool overviews
        const TILESMITH_OVERVIEW = `
            <p>Tilesmith is your pixel art creation studio within Game Wizard. Design individual tiles or multi-tile tilesets for terrain, structures, vegetation, and more.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#127912;</span>
                    <div class="feature-text">
                        <strong>Pixel Editor</strong>
                        <span>Draw with pencil, fill, line, and rectangle tools. Full undo/redo support.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#129302;</span>
                    <div class="feature-text">
                        <strong>AI Generation</strong>
                        <span>Generate pixel art tiles from text descriptions. Specify style, biome, and more.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128200;</span>
                    <div class="feature-text">
                        <strong>Multi-Tile Grids</strong>
                        <span>Create larger assets like trees or buildings that span multiple tiles.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128230;</span>
                    <div class="feature-text">
                        <strong>Publish to Master</strong>
                        <span>Send tiles directly to your project's master spritesheet.</span>
                    </div>
                </div>
            </div>
        `;

        const SPRITE_RITE_OVERVIEW = `
            <p>Sprite-Rite handles importing external sprite assets into your Game Wizard project. Upload spritesheets, define sprite regions, and generate atlas data.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#128228;</span>
                    <div class="feature-text">
                        <strong>Import Spritesheets</strong>
                        <span>Drag and drop PNG, JPG, GIF, or WebP images to import.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#9634;</span>
                    <div class="feature-text">
                        <strong>Define Regions</strong>
                        <span>Click and drag to select sprite boundaries. Resize with handles.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128196;</span>
                    <div class="feature-text">
                        <strong>JSON Atlas Export</strong>
                        <span>Generate atlas JSON compatible with Phaser, PixiJS, and other engines.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128230;</span>
                    <div class="feature-text">
                        <strong>Master Sheet Integration</strong>
                        <span>Publish imported sprites to the project master sheet.</span>
                    </div>
                </div>
            </div>
        `;

        // Build documentation pages for each tool
        buildToolDocs('tilesmith', 'Tilesmith',
            'Create pixel art tiles with AI assistance. Support for multi-tile tilesets and seamless integration with the master spritesheet.',
            TILESMITH_OVERVIEW,
            typeof TILESMITH_DOCS !== 'undefined' ? TILESMITH_DOCS : null);

        buildToolDocs('sprite-rite', 'Sprite-Rite',
            'Import and manage sprite assets. Define sprite regions, generate atlas JSON, and publish to the master spritesheet.',
            SPRITE_RITE_OVERVIEW,
            typeof SPRITE_RITE_DOCS !== 'undefined' ? SPRITE_RITE_DOCS : null);

        const ANIMANCER_OVERVIEW = `
            <p>Animancer brings your sprites to life. Build frame-by-frame animations, control timing, and preview playback in real-time.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#127902;</span>
                    <div class="feature-text">
                        <strong>Timeline Editor</strong>
                        <span>Arrange frames, set durations, and reorder with drag-and-drop.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#9654;</span>
                    <div class="feature-text">
                        <strong>Real-Time Preview</strong>
                        <span>Play animations at various speeds. Step frame-by-frame.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128260;</span>
                    <div class="feature-text">
                        <strong>Tweening</strong>
                        <span>Optional crossfade transitions between frames for smooth motion.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128230;</span>
                    <div class="feature-text">
                        <strong>Master Sheet Integration</strong>
                        <span>Use sprites from Tilesmith and Sprite-Rite automatically.</span>
                    </div>
                </div>
            </div>
        `;

        buildToolDocs('animancer', 'Animancer',
            'Create and preview sprite animations. Build frame sequences, control timing, and export for your game engine.',
            ANIMANCER_OVERVIEW,
            typeof ANIMANCER_DOCS !== 'undefined' ? ANIMANCER_DOCS : null);

        const LEVEL_FORGE_OVERVIEW = `
            <p>Level Forge is your complete level design toolkit. Build collision maps, add parallax backgrounds, paint visual tiles, and test with built-in demo mode.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#9638;</span>
                    <div class="feature-text">
                        <strong>Grid Editor</strong>
                        <span>Define walkable areas, obstructions, spawns, and portal markers.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#127748;</span>
                    <div class="feature-text">
                        <strong>Background Editor</strong>
                        <span>Add layered backgrounds with parallax scrolling and retro Pixelify effects.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#127912;</span>
                    <div class="feature-text">
                        <strong>Tile Painter</strong>
                        <span>Paint visual sprites onto the level grid from your spritesheets.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#9654;</span>
                    <div class="feature-text">
                        <strong>Demo Mode</strong>
                        <span>Test levels with platformer or top-down physics built in.</span>
                    </div>
                </div>
            </div>
        `;

        buildToolDocs('level-forge', 'Level Forge',
            'Design complete game levels with collision editing, background art, visual tiles, and integrated demo testing.',
            LEVEL_FORGE_OVERVIEW,
            typeof LEVEL_FORGE_DOCS !== 'undefined' ? LEVEL_FORGE_DOCS : null);

        const INCARNUM_OVERVIEW = `
            <p>Incarnum assembles characters from your sprite and animation libraries. Define character types, link animations to behaviors, and add custom properties.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#127912;</span>
                    <div class="feature-text">
                        <strong>Sprite Selection</strong>
                        <span>Choose default sprites from your project's master spritesheet.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#127916;</span>
                    <div class="feature-text">
                        <strong>Animation Linking</strong>
                        <span>Map animations to behaviors: idle, walk, attack, and custom actions.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#127991;</span>
                    <div class="feature-text">
                        <strong>Tags & Properties</strong>
                        <span>Add metadata for filtering and game logic.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128101;</span>
                    <div class="feature-text">
                        <strong>Character Library</strong>
                        <span>Manage all characters with filtering by type.</span>
                    </div>
                </div>
            </div>
        `;

        buildToolDocs('incarnum', 'Incarnum',
            'Assemble characters from sprites and animations. Define types, behaviors, tags, and custom properties.',
            INCARNUM_OVERVIEW,
            typeof INCARNUM_DOCS !== 'undefined' ? INCARNUM_DOCS : null);

        const CRUCIBLE_OVERVIEW = `
            <p>The Crucible of Code is your project command center. Create projects, manage levels, and compile all your game data into exportable JSON.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#128193;</span>
                    <div class="feature-text">
                        <strong>Project Management</strong>
                        <span>Organize levels into projects with independent spritesheets.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128202;</span>
                    <div class="feature-text">
                        <strong>Level Dashboard</strong>
                        <span>Track completion with status cards for grid, backgrounds, tiles, and spawns.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128279;</span>
                    <div class="feature-text">
                        <strong>Tool Integration</strong>
                        <span>Connects Tilesmith, Sprite-Rite, Animancer, and Level Forge.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128230;</span>
                    <div class="feature-text">
                        <strong>JSON Export</strong>
                        <span>Compile and export game-ready level data for your engine.</span>
                    </div>
                </div>
            </div>
        `;

        buildToolDocs('crucible', 'Crucible of Code',
            'Your project command center. Create projects, manage levels, and compile data from all Game Wizard tools into exportable JSON.',
            CRUCIBLE_OVERVIEW,
            typeof CRUCIBLE_DOCS !== 'undefined' ? CRUCIBLE_DOCS : null);

        const PORTALS_OVERVIEW = `
            <p>Portals connects your game's levels together. Visualize level flow, link exits to spawn points, and validate your connections.</p>
            <div class="feature-grid">
                <div class="feature-item">
                    <span class="feature-icon">&#128506;</span>
                    <div class="feature-text">
                        <strong>Node Mapper</strong>
                        <span>Visual canvas with draggable level nodes and pathway lines.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#128279;</span>
                    <div class="feature-text">
                        <strong>Level Connections</strong>
                        <span>Link exit points to spawn points in other levels.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#8644;</span>
                    <div class="feature-text">
                        <strong>Bidirectional</strong>
                        <span>Create two-way connections for backtracking and exploration.</span>
                    </div>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">&#10003;</span>
                    <div class="feature-text">
                        <strong>Validation</strong>
                        <span>Check for unconfigured exits and missing spawn points.</span>
                    </div>
                </div>
            </div>
        `;

        buildToolDocs('portals', 'Portals',
            'Connect your game levels together. Link exits to spawns, create bidirectional paths, and validate your level flow.',
            PORTALS_OVERVIEW,
            typeof PORTALS_DOCS !== 'undefined' ? PORTALS_DOCS : null);

        function navigateTo(hash) {
            const page = hash.replace('#', '') || 'welcome';

            // Update active nav link (handle sub-pages)
            const topPage = page.split('/')[0];
            document.querySelectorAll('.nav-link').forEach(link => {
                const linkPage = link.getAttribute('href').replace('#', '');
                link.classList.toggle('active', linkPage === topPage || linkPage === page);
            });

            // For now, show welcome for undefined pages
            if (!pages[page]) {
                document.getElementById('content').innerHTML = `
                    <div class="content-header">
                        <h1 class="content-title">${page.charAt(0).toUpperCase() + page.split('/')[0].replace(/-/g, ' ')}</h1>
                        <p class="content-subtitle">Documentation coming soon...</p>
                    </div>
                `;
                return;
            }

            document.getElementById('content').innerHTML = pages[page];
        }

        // Handle navigation
        window.addEventListener('hashchange', () => navigateTo(location.hash));
        document.querySelectorAll('.nav-link, .tool-card').forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                if (href && href.startsWith('#')) {
                    e.preventDefault();
                    location.hash = href;
                }
            });
        });

        // Initial load
        navigateTo(location.hash || '#welcome');
    </script>
</body>
</html>
